
# Employee Registration System using Invite Codes

## Overview
This system allows employees to register using a **unique invite code** generated by the admin. When an invite code is used for registration, the employee inherits the **department** and **permissions** associated with that code.

---

## ✅ System Components

### **Main Collections**
1. **Employees** – Stores employee details.
2. **Departments** – Stores department data.
3. **Roles** – Stores roles and their general permissions.
4. **InviteCodes** – Stores the invite codes for registration.

---

## ✅ How the System Works
1. An **invite code** is created and linked to a department and specific permissions.
2. The employee enters the code during registration.
3. The system checks:
   - If the code exists.
   - If the code is not used yet.
4. If valid:
   - Create a new employee account with the department and permissions from the code.
   - Update the invite code status to **used**.

---

## ✅ Database Design (MongoDB)

### **Collections and Fields**
- **Departments**
  - `_id` (ObjectId) – Department ID.
  - `name` (String) – Department name.

- **Roles**
  - `_id` (ObjectId) – Role ID.
  - `name` (String) – Role name (e.g., Admin, HR, Staff).
  - `permissions` (Array or Object) – General permissions for this role.
.

- **InviteCodes**
  - `_id` (ObjectId) – Invite code ID.
  - `code` (String, unique) – Actual invite code.
  - `department_id` (ObjectId) – Linked department.
  - `permissions` (Object) – Specific permissions for this code.
  - `is_used` (Boolean) – Whether the code has been used (default: false).
  - `used_by` (ObjectId) – Employee who used the code (if any).
  - `status` (String: 'active', 'used') – Current status of the code.
  - `created_at` (Date) – When the code was created.

---

## ✅ Relationships
- One department can have many employees: **Departments → Employees (1:N)**
- One role can be assigned to many employees: **Roles → Employees (1:N)**
- One department can have many invite codes: **Departments → InviteCodes (1:N)**
- One invite code can be linked to one employee after use: **InviteCodes → Employees (0:1)**

---

## ✅ Business Logic for Invite Codes
1. The user enters an invite code during registration.
2. The system checks:
   - Does the code exist in the `InviteCodes` collection?
   - Is `is_used = false`?
3. If valid:
   - Create an employee document with department and permissions.
   - Update the invite code:
     - `is_used = true`
     - `used_by = employee._id`

---

## ✅ MongoDB Schema Examples (Mongoose)
```js
const DepartmentSchema = new Schema({
  name: { type: String, required: true }
});

const RoleSchema = new Schema({
  name: { type: String, required: true },
  permissions: { type: Object, required: true }
});


const InviteCodeSchema = new Schema({
  code: { type: String, required: true, unique: true },
  department_id: { type: Schema.Types.ObjectId, ref: 'Department' },
  permissions: { type: Object, required: true },
  is_used: { type: Boolean, default: false },
  used_by: { type: Schema.Types.ObjectId, ref: 'Employee' },
  status: { type: String, enum: ['active', 'used'], default: 'active' },
  created_at: { type: Date, default: Date.now }
});
```
